<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Carrito de Compras</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .producto { display: flex; justify-content: space-between; margin-bottom: 10px; align-items: center; }
    .carrito, .totales { border: 1px solid #ccc; padding: 20px; margin-top: 20px; }
    .totales { background-color: #f9f9f9; }
    .verde { background-color: #28d163; color: white; padding: 10px; border: none; cursor: pointer; }
    .volver { background-color: #ccc; padding: 10px; border: none; cursor: pointer; margin-bottom: 10px; }
    .eliminar { background: red; color: white; border: none; padding: 4px 8px; cursor: pointer; margin-left: 10px; }
  </style>
</head>
<body>
  <h1>Tienda de Camisetas</h1>
  <div id="inicio">
    <button onclick="addToCart('Camiseta Atl√©tico 24/25', 33.95)">A√±adir Camiseta Atl√©tico 24/25</button>
    <button onclick="addToCart('Camiseta Chelsea 24/25', 33.95)">A√±adir Camiseta Chelsea 24/25</button>
    <button onclick="toggleCarrito()">üõí Ver Carrito</button>
  </div>

  <div id="carrito" class="carrito" style="display: none;">
    <button class="volver" onclick="volverAComprar()">‚Üê Volver a comprar</button>
    <h2>Carrito</h2>
    <form id="form-carrito" onsubmit="event.preventDefault(); actualizarTotales();">
      <div id="lista-productos"></div>
      <button type="submit">Actualizar el carrito</button>
    </form>

    <div>
      <input type="text" id="cupon" placeholder="C√≥digo de cup√≥n">
      <button onclick="aplicarCupon()">Aplicar el cup√≥n</button>
    </div>

    <div class="totales">
      <p>Subtotal: <span id="subtotal">0.00</span> ‚Ç¨</p>
      <p>Env√≠o gratuito</p>
      <p>Enviar a <strong>Barcelona</strong></p>
      <p>Total: <span id="total">0.00</span> ‚Ç¨</p>
      <button class="verde">Proceder al pago</button>
    </div>
    <p><strong>AVISO IMPORTANTE:</strong> ESTE PRODUCTO NO PERMITE DEVOLUCI√ìN.</p>
  </div>

  <script>
    let carrito = [];
    let descuentoAplicado = false;

    function toggleCarrito() {
      document.getElementById('inicio').style.display = 'none';
      document.getElementById('carrito').style.display = 'block';
      renderCarrito();
    }

    function volverAComprar() {
      document.getElementById('carrito').style.display = 'none';
      document.getElementById('inicio').style.display = 'block';
    }

    function addToCart(nombre, precio) {
      const productoExistente = carrito.find(p => p.nombre === nombre);
      if (productoExistente) {
        productoExistente.cantidad++;
      } else {
        carrito.push({ nombre, precio, cantidad: 1 });
      }
      renderCarrito();
    }

    function eliminarProducto(index) {
      carrito.splice(index, 1);
      renderCarrito();
    }

    function renderCarrito() {
      const contenedor = document.getElementById('lista-productos');
      contenedor.innerHTML = '';
      carrito.forEach((producto, index) => {
        contenedor.innerHTML += `
          <div class="producto">
            <span>${producto.nombre}</span>
            <span>${producto.precio.toFixed(2)} ‚Ç¨</span>
            <input type="number" min="1" value="${producto.cantidad}" name="cantidad-${index}" id="cantidad-${index}">
            <span id="subtotal-${index}">${(producto.precio * producto.cantidad).toFixed(2)} ‚Ç¨</span>
            <button class="eliminar" onclick="eliminarProducto(${index})">‚úï</button>
          </div>
        `;
      });
      calcularTotales();
    }

    function actualizarTotales() {
      carrito.forEach((producto, index) => {
        const nuevaCantidad = parseInt(document.getElementById(`cantidad-${index}`).value);
        producto.cantidad = isNaN(nuevaCantidad) || nuevaCantidad < 1 ? 1 : nuevaCantidad;
        document.getElementById(`subtotal-${index}`).textContent = (producto.precio * producto.cantidad).toFixed(2) + ' ‚Ç¨';
      });
      calcularTotales();
    }

    function calcularTotales() {
      let subtotal = carrito.reduce((acc, prod) => acc + prod.precio * prod.cantidad, 0);
      let total = descuentoAplicado ? subtotal * 0.9 : subtotal;
      document.getElementById('subtotal').textContent = subtotal.toFixed(2);
      document.getElementById('total').textContent = total.toFixed(2);
    }

    function aplicarCupon() {
      const codigo = document.getElementById('cupon').value.trim();
      if (codigo === 'Joseponmeun10') {
        descuentoAplicado = true;
        calcularTotales();
      } else {
        alert('Cup√≥n no v√°lido');
      }
    }
  </script>
</body>
</html>
